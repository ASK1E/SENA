<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SENA - Scanning Engineering Network Assistant</title>
  
  <!-- Preload Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

    * {
      font-family: 'Poppins', sans-serif;
    }

    /* Loader styles */
    .loader {
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-left-color: #3b82f6;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      animation: spin 1s linear infinite;
      display: inline-block;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Typing cursor animation */
    .typing-cursor::after {
      content: '|';
      animation: blink 1s infinite;
      color: #3b82f6;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Background gradients */
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    /* Glass morphism effect */
    .glass-effect {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Floating animation */
    .floating {
      animation: floating 3s ease-in-out infinite;
    }

    @keyframes floating {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    /* Enhanced fade-in animations */
    .fade-in-up {
      opacity: 0;
      transform: translateY(50px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .fade-in-up.animate {
      opacity: 1;
      transform: translateY(0);
    }

    .fade-in-left {
      opacity: 0;
      transform: translateX(-50px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .fade-in-left.animate {
      opacity: 1;
      transform: translateX(0);
    }

    .fade-in-right {
      opacity: 0;
      transform: translateX(50px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .fade-in-right.animate {
      opacity: 1;
      transform: translateX(0);
    }

    .fade-in {
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .fade-in.animate {
      opacity: 1;
      transform: scale(1);
    }

    /* Staggered animation delays */
    .stagger-1 { transition-delay: 0.1s; }
    .stagger-2 { transition-delay: 0.2s; }
    .stagger-3 { transition-delay: 0.3s; }
    .stagger-4 { transition-delay: 0.4s; }
    .stagger-5 { transition-delay: 0.5s; }
    .stagger-6 { transition-delay: 0.6s; }

    /* Pulse button animation */
    .pulse-button {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
      100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
    }

    /* Hero pattern */
    .hero-pattern {
      background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.1) 1px, transparent 0);
      background-size: 20px 20px;
    }

    /* Sidebar styles */
    .sidebar {
      background: rgba(17, 24, 39, 0.98);
      backdrop-filter: blur(20px);
      box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease-in-out;
    }

    .sidebar-collapsed {
      width: 80px;
    }

    .sidebar-expanded {
      width: 280px;
    }

    /* Sidebar text visibility */
    .sidebar-collapsed .sidebar-text {
      opacity: 0;
      transform: translateX(-20px);
      pointer-events: none;
    }

    .sidebar-expanded .sidebar-text {
      opacity: 1;
      transform: translateX(0);
      transition: all 0.3s ease-in-out 0.1s;
    }

    /* Main content adjustment */
    .main-content {
      transition: all 0.3s ease-in-out;
    }

    .main-content.sidebar-expanded {
      margin-left: 280px !important;
      width: calc(100% - 280px) !important;
    }

    .main-content.sidebar-collapsed {
      margin-left: 80px !important;
      width: calc(100% - 80px) !important;
    }

    /* Stats cards */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 1.5rem;
      border-radius: 1rem;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      background: rgba(255, 255, 255, 0.15);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .stat-label {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.9rem;
    }

    /* Enhanced input styles */
    .enhanced-input, .enhanced-select {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid transparent;
      border-radius: 0.75rem;
      transition: all 0.3s ease;
    }

    .enhanced-input:focus, .enhanced-select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    /* Status badges */
    .status-success {
      background: #10b981;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .status-error {
      background: #ef4444;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .status-warning {
      background: #f59e0b;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    /* Action buttons */
    .action-btn {
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      transition: all 0.2s ease;
      border: none;
      cursor: pointer;
    }

    .action-btn-primary {
      background: #3b82f6;
      color: white;
    }

    .action-btn-primary:hover {
      background: #2563eb;
    }

    .action-btn-danger {
      background: #ef4444;
      color: white;
    }

    .action-btn-danger:hover {
      background: #dc2626;
    }

    .action-btn-success {
      background: #10b981;
      color: white;
    }

    .action-btn-success:hover {
      background: #059669;
    }

    /* Risk level indicators */
    .risk-high {
      color: #ef4444;
      font-weight: bold;
    }

    .risk-medium {
      color: #f59e0b;
      font-weight: bold;
    }

    .risk-low {
      color: #10b981;
      font-weight: bold;
    }

    .risk-safe {
      color: #6b7280;
      font-weight: bold;
    }

    /* Notification styles */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: white;
      font-weight: 600;
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
      max-width: 400px;
    }

    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }

    .notification-success {
      background: #10b981;
    }

    .notification-error {
      background: #ef4444;
    }

    .notification-warning {
      background: #f59e0b;
    }

    .notification-info {
      background: #3b82f6;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.mobile-open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0 !important;
        width: 100% !important;
      }

      .stats-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
      }
    }
  </style>
</head>

<body class="bg-gray-900 text-white min-h-screen overflow-x-hidden">
  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar sidebar-expanded fixed left-0 top-0 h-full z-50 flex flex-col">
    <!-- Sidebar Header -->
    <div class="p-4 border-b border-gray-700">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div id="sidebar-logo" class="w-10 h-10 bg-blue-500 rounded-xl flex items-center justify-center cursor-pointer">
            <span class="text-lg font-bold">S</span>
          </div>
          <div class="sidebar-text">
            <h1 class="text-xl font-bold text-blue-400">SENA</h1>
            <p class="text-xs text-gray-400">Dashboard</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar Navigation -->
    <nav class="flex-1 p-4">
      <ul class="space-y-2">
        <li>
          <a href="#home" class="menu-item flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-700 transition-colors group bg-gray-700">
            <svg class="w-6 h-6 text-blue-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
            <span class="sidebar-text group-hover:text-blue-400 whitespace-nowrap">Home</span>
          </a>
        </li>
        <li>
          <a href="#scanning" class="menu-item flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-700 transition-colors group">
            <svg class="w-6 h-6 text-green-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <span class="sidebar-text group-hover:text-green-400 whitespace-nowrap">Scanning</span>
          </a>
        </li>
        <li>
          <a href="#history" class="menu-item flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-700 transition-colors group">
            <svg class="w-6 h-6 text-orange-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span class="sidebar-text group-hover:text-orange-400 whitespace-nowrap">History</span>
          </a>
        </li>
        <li>
          <a href="#about" class="menu-item flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-700 transition-colors group">
            <svg class="w-6 h-6 text-purple-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span class="sidebar-text group-hover:text-purple-400 whitespace-nowrap">About</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Sidebar Footer -->
    <div class="p-4 border-t border-gray-700">
      <div class="flex items-center space-x-3 mb-4">
        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
        </div>
        <div class="sidebar-text">
          <p id="user-name" class="text-sm font-medium whitespace-nowrap">Loading...</p>
          <p id="user-email" class="text-xs text-gray-400 whitespace-nowrap">Loading...</p>
        </div>
      </div>
      <button onclick="logout()" class="menu-item w-full flex items-center space-x-3 p-2 text-red-400 hover:bg-red-900/20 rounded-lg transition-colors">
        <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
        </svg>
        <span class="sidebar-text whitespace-nowrap">Logout</span>
      </button>
    </div>
  </aside>

  <!-- Mobile Menu Button -->
  <button id="mobile-menu-btn" class="md:hidden fixed top-4 left-4 z-50 p-2 bg-gray-800 rounded-lg">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>

  <!-- Main Content -->
  <div id="main-content" class="main-content sidebar-expanded min-h-screen w-full">
    <!-- Enhanced Header Section - Welcome Dashboard -->
    <header id="home" class="gradient-bg hero-pattern py-20 text-white fade-in-up min-h-screen flex items-center">
      <div class="container mx-auto px-6 text-center">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-5xl md:text-6xl font-bold mb-6 tracking-tight drop-shadow-lg fade-in-up">
            <span id="typing-text" class="typing-cursor"></span>
          </h2>
          <p class="text-xl md:text-2xl text-gray-300 max-w-2xl mx-auto mb-8 fade-in-up stagger-1">
            Your personal security command center. Monitor, scan, and protect your network infrastructure.
          </p>
          
          <!-- User Stats Dashboard -->
          <div class="stats-container fade-in-up stagger-2">
            <div class="stat-card group">
              <div class="stat-value text-blue-400" id="scans-today">0</div>
              <div class="stat-label">Scans Today</div>
            </div>
            <div class="stat-card group">
              <div class="stat-value text-green-400" id="total-scans">0</div>
              <div class="stat-label">Total Scans</div>
            </div>
            <div class="stat-card group">
              <div class="stat-value text-yellow-400" id="threats-found">0</div>
              <div class="stat-label">Threats Found</div>
            </div>
            <div class="stat-card group">
              <div class="stat-value text-purple-400" id="security-score">100%</div>
              <div class="stat-label">Security Score</div>
            </div>
          </div>
          
          <a href="#scanning" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-4 rounded-full transition-all duration-300 transform hover:scale-105 fade-in-up stagger-3 mt-8">
            🔍 Start New Scan
          </a>
        </div>
      </div>
    </header>

    <!-- Enhanced Scanning Section -->
    <main class="bg-gray-800 min-h-screen" id="scanning">
      <div class="h-full p-0">
        <div class="text-center pt-10 pb-6 fade-in-up">
          <h2 class="text-4xl font-bold mb-4 text-blue-400">Network Scanning Tools</h2>
          <p class="text-gray-400 text-lg">Advanced port scanning system using TCP and SYN – built with power and precision.</p>
        </div>

        <!-- Full Width Scan Configuration Card -->
        <div class="h-full px-6">
          <div class="glass-effect p-8 text-lg rounded-2xl fade-in-up floating h-full min-h-[calc(100vh-200px)] space-y-8">
            <h3 class="text-2xl font-semibold mb-8 text-center text-blue-400 fade-in-up stagger-1">
              🔧 Scan Configuration
            </h3>

            <!-- Scan Configuration Form -->
            <div class="space-y-6">
              <!-- IP Input -->
              <div class="fade-in-up stagger-2">
                <label class="block text-lg font-medium mb-3 text-gray-300">Target IP Address</label>
                <input 
                  id="ip" 
                  type="text" 
                  placeholder="Enter target IP address (e.g., 192.168.1.1)" 
                  class="w-full px-6 py-4 text-lg rounded-xl enhanced-input text-black"
                />
              </div>

              <!-- Port Range -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 fade-in-up stagger-3">
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">Start Port</label>
                  <input 
                    id="start_port" 
                    type="number" 
                    value="1" 
                    min="1" 
                    max="65535" 
                    class="w-full px-6 py-4 text-lg rounded-xl enhanced-input text-black"
                  />
                </div>
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">End Port</label>
                  <input 
                    id="end_port" 
                    type="number" 
                    value="1000" 
                    min="1" 
                    max="65535" 
                    class="w-full px-6 py-4 text-lg rounded-xl enhanced-input text-black"
                  />
                </div>
              </div>

              <!-- Mode and Traversal Selection -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 fade-in-up stagger-4">
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">Scan Mode</label>
                  <select id="mode" class="w-full px-6 py-4 text-lg rounded-xl enhanced-select text-black">
                    <option value="tcp">TCP Connect</option>
                    <option value="syn">SYN (Stealth)</option>
                  </select>
                </div>
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">Traversal Method</label>
                  <select id="traversal" class="w-full px-6 py-4 text-lg rounded-xl enhanced-select text-black">
                    <option value="bfs">BFS (Breadth-First)</option>
                    <option value="dfs">DFS (Depth-First)</option>
                    <option value="adaptive">Adaptive (BFS+DFS)</option>
                    <option value="sequential">Sequential</option>
                  </select>
                </div>
              </div>

              <!-- Threads and Fingerprint -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 fade-in-up stagger-5">
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">Maximum Threads</label>
                  <input 
                    id="threads" 
                    type="number" 
                    value="50" 
                    min="1" 
                    max="1000" 
                    class="w-full px-6 py-4 text-lg rounded-xl enhanced-input text-black"
                  />
                </div>
                <div>
                  <label class="block text-lg font-medium mb-3 text-gray-300">Service Fingerprinting</label>
                  <select id="fingerprint" class="w-full px-6 py-4 text-lg rounded-xl enhanced-select text-black">
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                  </select>
                </div>
              </div>

              <!-- Scan Button -->
              <button 
                onclick="startScan()" 
                id="scan-btn"
                class="w-full bg-blue-500 hover:bg-blue-600 text-white py-4 text-lg rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 fade-in-up stagger-6 pulse-button"
              >
                🔍 Start Scan
              </button>

              <!-- Loading Indicator -->
              <div id="loading" class="flex items-center justify-center space-x-3 mt-6 hidden fade-in">
                <span class="loader"></span>
                <span class="text-xl text-blue-400 font-medium">Scanning in progress...</span>
              </div>
            </div>

            <!-- Scan Results -->
            <div class="fade-in-up stagger-7">
              <label class="block text-lg font-medium mb-3 text-gray-300">Scan Results</label>
              <pre id="output" class="glass-effect p-6 rounded-xl text-white h-full min-h-[500px] text-base font-mono whitespace-pre-wrap overflow-auto"></pre>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- History Section -->
    <section id="history" class="py-20 bg-gray-800 min-h-screen">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12 fade-in-up">
          <h2 class="text-4xl font-bold mb-4 text-orange-400">Scan History</h2>
          <p class="text-gray-400 text-lg">Review your previous network scanning activities and results.</p>
        </div>

        <!-- History Controls -->
        <div class="glass-effect p-6 rounded-2xl mb-8 fade-in-up stagger-1">
          <div class="flex flex-col md:flex-row flex-wrap justify-between items-center gap-4">
            <!-- Search and Filter -->
            <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 flex-1 w-full md:w-auto">
              <input 
                id="history-search" 
                type="text" 
                placeholder="Search by IP address..." 
                class="px-4 py-2 rounded-lg enhanced-input text-black flex-1"
              />
              <select id="history-filter" class="px-4 py-2 rounded-lg enhanced-select text-black">
                <option value="all">All Scans</option>
                <option value="high_risk">High Risk</option>
                <option value="medium_risk">Medium Risk</option>
                <option value="low_risk">Low Risk</option>
              </select>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex space-x-2">
              <button 
                onclick="refreshHistory()" 
                class="action-btn action-btn-primary"
              >
                🔄 Refresh
              </button>
              <button 
                onclick="clearHistory()" 
                class="action-btn action-btn-danger"
              >
                🗑️ Clear History
              </button>
            </div>
          </div>
        </div>

        <!-- History Table -->
        <div class="glass-effect rounded-2xl overflow-hidden fade-in-up stagger-2">
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead class="bg-gray-700">
                <tr>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Date & Time</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Target IP</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Mode</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Open Ports</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Risk Level</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Duration</th>
                  <th class="px-6 py-4 text-left text-sm font-semibold text-gray-300">Actions</th>
                </tr>
              </thead>
              <tbody id="history-table-body" class="divide-y divide-gray-700">
                <!-- History entries will be populated here -->
              </tbody>
            </table>
          </div>
          
          <!-- Empty State -->
          <div id="history-empty" class="text-center py-16 hidden">
            <div class="text-6xl mb-4">📋</div>
            <h3 class="text-xl font-semibold text-gray-300 mb-2">No Scan History</h3>
            <p class="text-gray-500">Start your first scan to see results here.</p>
          </div>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="flex justify-center mt-8 space-x-2 hidden">
          <button onclick="previousPage()" id="prev-btn" class="action-btn action-btn-primary" disabled>Previous</button>
          <span id="page-info" class="flex items-center px-4 py-2 text-gray-300">Page 1 of 1</span>
          <button onclick="nextPage()" id="next-btn" class="action-btn action-btn-primary" disabled>Next</button>
        </div>
      </div>
    </section>

    <!-- History Detail Modal -->
    <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
      <div class="glass-effect rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-gray-700">
          <div class="flex justify-between items-center">
            <h3 class="text-2xl font-bold text-orange-400">Scan Details</h3>
            <button onclick="closeHistoryModal()" class="text-gray-400 hover:text-white">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div id="history-modal-content" class="p-6">
          <!-- Modal content will be populated here -->
        </div>
      </div>
    </div>

    <!-- About SENA Section -->
    <section id="about" class="py-20 bg-gray-900 min-h-screen flex items-center">
      <div class="container mx-auto px-6">
        <div class="grid md:grid-cols-2 gap-12 items-center">
          <!-- Logo Section -->
          <div class="text-center fade-in-left">
            <div class="mb-8 floating">
              <div class="w-64 h-64 mx-auto bg-white/10 rounded-3xl backdrop-blur-sm border border-white/20 flex items-center justify-center p-6">
                <div class="w-full h-full flex items-center justify-center text-6xl font-bold text-blue-400">
                  SENA
                </div>
              </div>
            </div>
          </div>

          <!-- About Content -->
          <div class="fade-in-right">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">About SENA</h2>
            <div class="space-y-6">
              <p class="text-gray-300 leading-relaxed text-lg fade-in-right stagger-1">
                SENA adalah platform inovatif untuk pengelolaan keamanan jaringan dengan teknologi AI terdepan. 
                Kami membantu mengidentifikasi dan mengatasi ancaman keamanan secara real-time dengan akurasi tinggi.
              </p>
              <p class="text-gray-300 leading-relaxed fade-in-right stagger-2">
                Dengan kombinasi machine learning dan expertise keamanan siber, SENA memberikan solusi komprehensif 
                untuk melindungi infrastruktur digital organisasi Anda dari berbagai jenis ancaman cyber.
              </p>
              
              <!-- Enhanced Statistics -->
              <div class="grid grid-cols-2 gap-6 mt-8">
                <div class="text-center p-6 glass-effect rounded-xl fade-in-up stagger-3 group hover:scale-105 transition-transform duration-300">
                  <div class="text-3xl font-bold text-blue-400 mb-2">99.9%</div>
                  <div class="text-gray-400">System Uptime</div>
                </div>
                <div class="text-center p-6 glass-effect rounded-xl fade-in-up stagger-4 group hover:scale-105 transition-transform duration-300">
                  <div class="text-3xl font-bold text-green-400 mb-2">24/7</div>
                  <div class="text-gray-400">Real-time Monitoring</div>
                </div>
                <div class="text-center p-6 glass-effect rounded-xl fade-in-up stagger-5 group hover:scale-105 transition-transform duration-300">
                  <div class="text-3xl font-bold text-purple-400 mb-2">1M+</div>
                  <div class="text-gray-400">Threats Detected</div>
                </div>
                <div class="text-center p-6 glass-effect rounded-xl fade-in-up stagger-6 group hover:scale-105 transition-transform duration-300">
                  <div class="text-3xl font-bold text-yellow-400 mb-2">&lt;1s</div>
                  <div class="text-gray-400">Response Time</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Enhanced Footer -->
    <footer class="bg-gray-900 py-8 border-t border-gray-800 fade-in-up">
      <div class="container mx-auto px-6 text-center">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <div class="text-2xl font-bold text-blue-400 mb-4 md:mb-0">SENA</div>
          <div class="text-gray-400">
            &copy; 2025 SENA Team - Scanning Engineering Network Assistant
          </div>
          <div class="flex space-x-4 mt-4 md:mt-0">
            <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Privacy</a>
            <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Terms</a>
            <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Support</a>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Notification Container -->
  <div id="notification-container"></div>

  <script>
    // SENA Dashboard JavaScript with Backend Integration
    // Configuration
    const API_BASE_URL = '/api'; // Adjust this to match your Flask backend URL
    const BACKEND_ROUTES = {
      scan: '/scan',
      history: '/history',
      stats: '/stats',
      exportPdf: '/scan/export/pdf',
      clearHistory: '/history/clear',
      userDashboard: '/user/dashboard'
    };

    // Global state
    let currentUser = null;
    let scanHistory = [];
    let currentPage = 1;
    let totalPages = 1;
    let currentFilter = 'all';
    let isScanning = false;

    // Initialize application
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
    });

    async function initializeApp() {
      try {
        setupAnimations();
        setupSidebar();
        setupNavigation();
        setupTypingEffect();
        
        // Load user information
        await loadUserInfo();
        
        // Load dashboard stats
        await updateDashboardStats();
        
        // Load scan history
        await loadScanHistory();
        
        // Setup event listeners
        setupEventListeners();
        
        console.log('🚀 SENA Dashboard initialized successfully!');
        showNotification('Dashboard loaded successfully!', 'success');
      } catch (error) {
        console.error('Failed to initialize dashboard:', error);
        showNotification('Failed to load dashboard. Please refresh the page.', 'error');
      }
    }

    // =====================================
    // USER MANAGEMENT
    // =====================================

    async function loadUserInfo() {
      try {
        const token = localStorage.getItem('jwt_token');
        if (!token) {
          // Redirect to login if no token
          window.location.href = '/login.html';
          return;
        }

        const response = await fetch(API_BASE_URL + BACKEND_ROUTES.userDashboard, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          const userData = await response.json();
          currentUser = userData;
          
          // Update UI with user info
          document.getElementById('user-name').textContent = userData.username || 'User';
          document.getElementById('user-email').textContent = userData.email || 'user@example.com';
          
          // Show verification status
          if (userData.verified) {
            document.getElementById('user-email').innerHTML += ' <span class="text-green-400">✓</span>';
          }
        } else {
          throw new Error('Failed to load user information');
        }
      } catch (error) {
        console.error('Error loading user info:', error);
        // Use default values if user info fails to load
        document.getElementById('user-name').textContent = 'Guest User';
        document.getElementById('user-email').textContent = 'guest@sena.local';
      }
    }

    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('jwt_token');
        window.location.href = '/login.html';
      }
    }

    // =====================================
    // SCANNING FUNCTIONALITY
    // =====================================

    async function startScan() {
      if (isScanning) {
        showNotification('A scan is already in progress', 'warning');
        return;
      }

      const ip = document.getElementById('ip').value.trim();
      const startPort = parseInt(document.getElementById('start_port').value);
      const endPort = parseInt(document.getElementById('end_port').value);
      const mode = document.getElementById('mode').value;
      const traversal = document.getElementById('traversal').value;
      const threads = parseInt(document.getElementById('threads').value);
      const fingerprint = document.getElementById('fingerprint').value === 'true';

      // Validation
      if (!ip) {
        showNotification('Please enter a target IP address', 'error');
        return;
      }

      if (!isValidIP(ip)) {
        showNotification('Please enter a valid IP address', 'error');
        return;
      }

      if (startPort > endPort) {
        showNotification('Start port must be less than or equal to end port', 'error');
        return;
      }

      if (startPort < 1 || endPort > 65535) {
        showNotification('Port range must be between 1 and 65535', 'error');
        return;
      }

      if (threads < 1 || threads > 1000) {
        showNotification('Thread count must be between 1 and 1000', 'error');
        return;
      }

      // Start scanning
      isScanning = true;
      const loadingElement = document.getElementById('loading');
      const outputElement = document.getElementById('output');
      const scanBtn = document.getElementById('scan-btn');

      // Update UI
      loadingElement.classList.remove('hidden');
      outputElement.textContent = 'Initializing scan...';
      scanBtn.disabled = true;
      scanBtn.textContent = '⏳ Scanning...';

      try {
        const response = await fetch(API_BASE_URL + BACKEND_ROUTES.scan, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            ip: ip,
            start_port: startPort,
            end_port: endPort,
            mode: mode,
            traversal: traversal,
            threads: threads,
            fingerprint: fingerprint
          })
        });

        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || `Server error: ${response.status}`);
        }

        // Display results
        displayScanResults(data);
        showNotification('Scan completed successfully!', 'success');
        
        // Update dashboard stats and history
        await updateDashboardStats();
        await loadScanHistory();

      } catch (error) {
        console.error('Scan error:', error);
        outputElement.textContent = `❌ Scan failed: ${error.message}`;
        showNotification('Scan failed. Please try again.', 'error');
      } finally {
        // Reset UI
        isScanning = false;
        loadingElement.classList.add('hidden');
        scanBtn.disabled = false;
        scanBtn.textContent = '🔍 Start Scan';
      }
    }

    function displayScanResults(data) {
      const outputElement = document.getElementById('output');
      
      if (!outputElement) return;
      
      let results = `🔍 Scan Results for ${data.target}\n`;
      results += `📊 Scan ID: ${data.scan_id}\n`;
      results += `🔧 Mode: ${data.mode.toUpperCase()}, Traversal: ${data.traversal.toUpperCase()}\n`;
      results += `🔢 Port Range: ${data.port_range} (${data.total_ports_scanned} ports scanned)\n`;
      results += `🧵 Threads: ${data.threads}\n`;
      results += `⏱️ Duration: ${data.scan_duration}s\n`;
      results += `🔐 Risk Level: ${getRiskLevelEmoji(data.risk_level)} ${data.risk_level}\n`;
      results += `📅 Timestamp: ${data.date} ${data.time}\n\n`;

      if (data.port_details && data.port_details.length > 0) {
        results += `✅ Open Ports (${data.open_ports_count}):\n`;
        data.port_details.forEach(port => {
          results += `  • ${port.port}/${data.mode} - ${port.service}`;
          if (port.banner && port.banner !== 'No banner') {
            results += ` (${port.banner})`;
          }
          results += '\n';
        });
        results += `\n❌ Closed Ports: ${data.closed_ports_count}\n`;
      } else {
        results += `❌ No open ports detected.\n`;
        results += `🔒 All ${data.total_ports_scanned} ports are closed or filtered.\n`;
      }

      // Add traversal statistics
      if (data.traversal_stats) {
        results += `\n📈 Traversal Statistics:\n`;
        results += `  • Method: ${data.traversal_stats.method_used.toUpperCase()}\n`;
        results += `  • Success Rate: ${data.traversal_stats.success_rate}%\n`;
        results += `  • Scan Order Preview: [${data.traversal_stats.scan_order_preview.join(', ')}...]\n`;
      }

      outputElement.textContent = results;
    }

    function getRiskLevelEmoji(riskLevel) {
      switch (riskLevel) {
        case 'High': return '🔴';
        case 'Medium': return '🟡';
        case 'Low': return '🟢';
        case 'Safe': return '✅';
        default: return '❓';
      }
    }

    function isValidIP(ip) {
      const ipRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
      return ipRegex.test(ip);
    }

    // =====================================
    // DASHBOARD STATS
    // =====================================

    async function updateDashboardStats() {
      try {
        const response = await fetch(API_BASE_URL + BACKEND_ROUTES.stats);
        
        if (response.ok) {
          const stats = await response.json();
          
          // Update stats in dashboard
          document.getElementById('scans-today').textContent = stats.scans_today || 0;
          document.getElementById('total-scans').textContent = stats.total_scans || 0;
          document.getElementById('threats-found').textContent = stats.threats_found || 0;
          document.getElementById('security-score').textContent = (stats.security_score || 100) + '%';
        }
      } catch (error) {
        console.error('Failed to update dashboard stats:', error);
      }
    }

    // =====================================
    // HISTORY MANAGEMENT
    // =====================================

    async function loadScanHistory(page = 1, filter = 'all') {
      try {
        const params = new URLSearchParams({
          page: page,
          per_page: 10,
          filter: filter,
          sort: 'date_desc'
        });

        const response = await fetch(`${API_BASE_URL}${BACKEND_ROUTES.history}?${params}`);
        
        if (response.ok) {
          const data = await response.json();
          scanHistory = data.history;
          currentPage = data.pagination.page;
          totalPages = data.pagination.total_pages;
          
          renderHistoryTable(data.history);
          updatePagination(data.pagination);
        } else {
          throw new Error('Failed to load scan history');
        }
      } catch (error) {
        console.error('Error loading scan history:', error);
        showNotification('Failed to load scan history', 'error');
      }
    }

    function renderHistoryTable(history) {
      const tbody = document.getElementById('history-table-body');
      const emptyState = document.getElementById('history-empty');
      
      if (!tbody) return;
      
      tbody.innerHTML = '';
      
      if (history.length === 0) {
        emptyState?.classList.remove('hidden');
        return;
      }
      
      emptyState?.classList.add('hidden');
      
      history.forEach((scan) => {
        const row = createHistoryRow(scan);
        tbody.appendChild(row);
      });
    }

    function createHistoryRow(scan) {
      const row = document.createElement('tr');
      row.className = 'hover:bg-gray-700/50 transition-colors';
      
      const riskClass = getRiskClass(scan.risk_level);
      
      row.innerHTML = `
        <td class="px-6 py-4 text-sm text-gray-300">
          ${scan.date}<br>
          <span class="text-xs text-gray-500">${scan.time}</span>
        </td>
        <td class="px-6 py-4 text-sm font-mono text-blue-400">${scan.target}</td>
        <td class="px-6 py-4 text-sm text-gray-300">
          <span class="bg-gray-700 px-2 py-1 rounded text-xs uppercase">${scan.mode}</span>
        </td>
        <td class="px-6 py-4 text-sm text-green-400 font-medium">${scan.open_ports_count}</td>
        <td class="px-6 py-4">
          <span class="${riskClass}">${scan.risk_level}</span>
        </td>
        <td class="px-6 py-4 text-sm text-gray-300">${scan.scan_duration}s</td>
        <td class="px-6 py-4">
          <div class="flex space-x-2">
            <button onclick="viewScanDetails('${scan.scan_id}')" class="action-btn action-btn-primary">
              👁️ View
            </button>
            <button onclick="exportScanPDF('${scan.scan_id}')" class="action-btn action-btn-success">
              📄 PDF
            </button>
            <button onclick="deleteScan('${scan.scan_id}')" class="action-btn action-btn-danger">
              🗑️ Delete
            </button>
          </div>
        </td>
      `;
      
      return row;
    }

    function getRiskClass(riskLevel) {
      switch (riskLevel) {
        case 'High': return 'risk-high';
        case 'Medium': return 'risk-medium';
        case 'Low': return 'risk-low';
        case 'Safe': return 'risk-safe';
        default: return 'risk-safe';
      }
    }

    async function viewScanDetails(scanId) {
      try {
        const response = await fetch(`${API_BASE_URL}${BACKEND_ROUTES.history}/${scanId}`);
        
        if (response.ok) {
          const scan = await response.json();
          showScanDetailsModal(scan);
        } else {
          throw new Error('Failed to load scan details');
        }
      } catch (error) {
        console.error('Error loading scan details:', error);
        showNotification('Failed to load scan details', 'error');
      }
    }

    function showScanDetailsModal(scan) {
      const modal = document.getElementById('history-modal');
      const content = document.getElementById('history-modal-content');
      
      content.innerHTML = `
        <div class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-4">
              <h4 class="text-lg font-semibold text-blue-400">Scan Information</h4>
              <div class="space-y-2">
                <p><span class="text-gray-400">Scan ID:</span> <span class="font-mono text-blue-400">${scan.scan_id}</span></p>
                <p><span class="text-gray-400">Target IP:</span> <span class="font-mono text-blue-400">${scan.target}</span></p>
                <p><span class="text-gray-400">Resolved IP:</span> <span class="font-mono text-blue-400">${scan.resolved_ip}</span></p>
                <p><span class="text-gray-400">Scan Mode:</span> <span class="uppercase">${scan.mode}</span></p>
                <p><span class="text-gray-400">Traversal:</span> <span class="uppercase">${scan.traversal}</span></p>
                <p><span class="text-gray-400">Threads:</span> ${scan.threads}</p>
                <p><span class="text-gray-400">Fingerprinting:</span> ${scan.fingerprint_enabled ? 'Enabled' : 'Disabled'}</p>
                <p><span class="text-gray-400">Duration:</span> ${scan.scan_duration}s</p>
                <p><span class="text-gray-400">Risk Level:</span> <span class="${getRiskClass(scan.risk_level)}">${scan.risk_level}</span></p>
              </div>
            </div>
            <div class="space-y-4">
              <h4 class="text-lg font-semibold text-green-400">Results Summary</h4>
              <div class="space-y-2">
                <p><span class="text-gray-400">Port Range:</span> ${scan.port_range}</p>
                <p><span class="text-gray-400">Total Scanned:</span> ${scan.total_ports_scanned}</p>
                <p><span class="text-gray-400">Open Ports:</span> <span class="text-green-400 font-bold">${scan.open_ports_count}</span></p>
                <p><span class="text-gray-400">Closed Ports:</span> ${scan.closed_ports_count}</p>
              </div>
              ${scan.port_details && scan.port_details.length > 0 ? `
                <div class="mt-4">
                  <h5 class="text-sm font-semibold text-gray-300 mb-2">Open Ports Details:</h5>
                  <div class="space-y-1 max-h-40 overflow-y-auto">
                    ${scan.port_details.map(port => `
                      <div class="bg-gray-700 p-2 rounded text-xs">
                        <span class="text-green-400 font-bold">${port.port}</span> - 
                        <span class="text-blue-400">${port.service}</span>
                        ${port.banner && port.banner !== 'No banner' ? `<br><span class="text-gray-400">${port.banner}</span>` : ''}
                      </div>
                    `).join('')}
                  </div>
                </div>
              ` : ''}
            </div>
          </div>
          
          ${scan.traversal_stats ? `
            <div>
              <h4 class="text-lg font-semibold text-purple-400 mb-4">Traversal Statistics</h4>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-gray-700 p-3 rounded">
                  <div class="text-sm text-gray-400">Method</div>
                  <div class="font-bold">${scan.traversal_stats.method_used.toUpperCase()}</div>
                </div>
                <div class="bg-gray-700 p-3 rounded">
                  <div class="text-sm text-gray-400">Success Rate</div>
                  <div class="font-bold text-green-400">${scan.traversal_stats.success_rate}%</div>
                </div>
                <div class="bg-gray-700 p-3 rounded">
                  <div class="text-sm text-gray-400">Ports Scanned</div>
                  <div class="font-bold">${scan.traversal_stats.total_ports_scanned}</div>
                </div>
                <div class="bg-gray-700 p-3 rounded">
                  <div class="text-sm text-gray-400">Scan Order</div>
                  <div class="font-bold text-xs">[${scan.traversal_stats.scan_order_preview.join(', ')}...]</div>
                </div>
              </div>
            </div>
          ` : ''}
        </div>
      `;
      
      modal.classList.remove('hidden');
    }

    function closeHistoryModal() {
      const modal = document.getElementById('history-modal');
      modal.classList.add('hidden');
    }

    async function exportScanPDF(scanId) {
      try {
        // Find the scan data
        const scan = scanHistory.find(s => s.scan_id === scanId);
        if (!scan) {
          throw new Error('Scan not found');
        }

        showNotification('Generating PDF report...', 'info');

        const response = await fetch(API_BASE_URL + BACKEND_ROUTES.exportPdf, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            scan_id: scanId,
            target: scan.target,
            mode: scan.mode,
            range: scan.port_range,
            open_ports: scan.open_ports
          })
        });

        if (response.ok) {
          // Create download link
          const blob = await response.blob();
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `scan_report_${scanId}.pdf`;
          document.body.appendChild(a);
          a.click();
          window.URL.revokeObjectURL(url);
          document.body.removeChild(a);
          
          showNotification('PDF report downloaded successfully!', 'success');
        } else {
          throw new Error('Failed to generate PDF');
        }
      } catch (error) {
        console.error('Error exporting PDF:', error);
        showNotification('Failed to export PDF report', 'error');
      }
    }

    async function deleteScan(scanId) {
      if (confirm('Are you sure you want to delete this scan?')) {
        try {
          const response = await fetch(`${API_BASE_URL}${BACKEND_ROUTES.history}/${scanId}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            showNotification('Scan deleted successfully', 'success');
            await loadScanHistory(currentPage, currentFilter);
            await updateDashboardStats();
          } else {
            throw new Error('Failed to delete scan');
          }
        } catch (error) {
          console.error('Error deleting scan:', error);
          showNotification('Failed to delete scan', 'error');
        }
      }
    }

    async function clearHistory() {
      if (confirm('Are you sure you want to clear all scan history? This action cannot be undone.')) {
        try {
          const response = await fetch(API_BASE_URL + BACKEND_ROUTES.clearHistory, {
            method: 'DELETE'
          });

          if (response.ok) {
            showNotification('Scan history cleared successfully', 'success');
            await loadScanHistory();
            await updateDashboardStats();
          } else {
            throw new Error('Failed to clear history');
          }
        } catch (error) {
          console.error('Error clearing history:', error);
          showNotification('Failed to clear history', 'error');
        }
      }
    }

    async function refreshHistory() {
      showNotification('Refreshing history...', 'info');
      await loadScanHistory(currentPage, currentFilter);
    }

    function updatePagination(pagination) {
      const paginationEl = document.getElementById('pagination');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const pageInfo = document.getElementById('page-info');

      if (pagination.total_pages > 1) {
        paginationEl.classList.remove('hidden');
        prevBtn.disabled = !pagination.has_prev;
        nextBtn.disabled = !pagination.has_next;
        pageInfo.textContent = `Page ${pagination.page} of ${pagination.total_pages}`;
      } else {
        paginationEl.classList.add('hidden');
      }
    }

    async function previousPage() {
      if (currentPage > 1) {
        await loadScanHistory(currentPage - 1, currentFilter);
      }
    }

    async function nextPage() {
      if (currentPage < totalPages) {
        await loadScanHistory(currentPage + 1, currentFilter);
      }
    }

    // =====================================
    // UI SETUP FUNCTIONS
    // =====================================

    function setupAnimations() {
      // Intersection Observer for scroll animations
      const animationObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate');
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      });

      // Observe all animation elements
      const animatedElements = document.querySelectorAll('.fade-in-up, .fade-in-left, .fade-in-right, .fade-in');
      animatedElements.forEach(el => animationObserver.observe(el));
    }

    function setupSidebar() {
      const sidebar = document.getElementById('sidebar');
      const logoButton = document.getElementById('sidebar-logo');
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mainContent = document.getElementById('main-content');

      // Toggle sidebar with logo click
      logoButton?.addEventListener('click', function() {
        toggleSidebar();
      });

      // Mobile menu toggle
      mobileMenuBtn?.addEventListener('click', function() {
        sidebar.classList.toggle('mobile-open');
      });

      // Close mobile menu when clicking outside
      document.addEventListener('click', function(e) {
        if (window.innerWidth <= 768) {
          if (!sidebar.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
            sidebar.classList.remove('mobile-open');
          }
        }
      });
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const mainContent = document.getElementById('main-content');
      
      if (sidebar.classList.contains('sidebar-expanded')) {
        sidebar.classList.remove('sidebar-expanded');
        sidebar.classList.add('sidebar-collapsed');
        mainContent.classList.remove('sidebar-expanded');
        mainContent.classList.add('sidebar-collapsed');
      } else {
        sidebar.classList.remove('sidebar-collapsed');
        sidebar.classList.add('sidebar-expanded');
        mainContent.classList.remove('sidebar-collapsed');
        mainContent.classList.add('sidebar-expanded');
      }
    }

    function setupNavigation() {
      const navLinks = document.querySelectorAll('nav a[href^="#"]');
      
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const targetId = this.getAttribute('href').substring(1);
          const targetElement = document.getElementById(targetId);
          
          if (targetElement) {
            // Smooth scroll to target
            targetElement.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
            
            // Update active nav state
            updateActiveNav(targetId);
            
            // Close mobile menu if open
            if (window.innerWidth <= 768) {
              document.getElementById('sidebar').classList.remove('mobile-open');
            }
          }
        });
      });

      // Update active nav on scroll
      window.addEventListener('scroll', debounce(updateActiveNavOnScroll, 100));
    }

    function updateActiveNav(activeId) {
      const navLinks = document.querySelectorAll('nav a[href^="#"]');
      navLinks.forEach(link => {
        link.classList.remove('bg-gray-700');
        if (link.getAttribute('href') === `#${activeId}`) {
          link.classList.add('bg-gray-700');
        }
      });
    }

    function updateActiveNavOnScroll() {
      const sections = ['home', 'scanning', 'history', 'about'];
      const scrollPos = window.scrollY + 100;
      
      for (let section of sections) {
        const element = document.getElementById(section);
        if (element) {
          const elementTop = element.offsetTop;
          const elementBottom = elementTop + element.offsetHeight;
          
          if (scrollPos >= elementTop && scrollPos < elementBottom) {
            updateActiveNav(section);
            break;
          }
        }
      }
    }

    function setupTypingEffect() {
      const typingElement = document.getElementById('typing-text');
      const messages = [
        'Welcome to SENA',
        'Scanning Engineering Network Assistant',
        'Advanced Security Solutions',
        'Real-time Network Monitoring'
      ];
      
      let messageIndex = 0;
      let charIndex = 0;
      let isDeleting = false;
      
      function typeMessage() {
        const currentMessage = messages[messageIndex];
        
        if (isDeleting) {
          typingElement.textContent = currentMessage.substring(0, charIndex - 1);
          charIndex--;
        } else {
          typingElement.textContent = currentMessage.substring(0, charIndex + 1);
          charIndex++;
        }
        
        let typeSpeed = isDeleting ? 50 : 100;
        
        if (!isDeleting && charIndex === currentMessage.length) {
          typeSpeed = 2000;
          isDeleting = true;
        } else if (isDeleting && charIndex === 0) {
          isDeleting = false;
          messageIndex = (messageIndex + 1) % messages.length;
          typeSpeed = 500;
        }
        
        setTimeout(typeMessage, typeSpeed);
      }
      
      if (typingElement) {
        setTimeout(typeMessage, 1000);
      }
    }

    function setupEventListeners() {
      // History search and filter
      const searchInput = document.getElementById('history-search');
      const filterSelect = document.getElementById('history-filter');
      
      searchInput?.addEventListener('input', debounce(filterHistory, 300));
      filterSelect?.addEventListener('change', filterHistory);

      // Close modal when clicking outside
      document.addEventListener('click', function(e) {
        const modal = document.getElementById('history-modal');
        if (e.target === modal) {
          closeHistoryModal();
        }
      });

      // Keyboard shortcuts
      document.addEventListener('keydown', function(e) {
        // Escape key to close modal
        if (e.key === 'Escape') {
          closeHistoryModal();
        }
        
        // Ctrl/Cmd + Enter to start scan (when in scanning section)
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
          const scanningSection = document.getElementById('scanning');
          if (isElementInViewport(scanningSection)) {
            startScan();
          }
        }
      });

      // Handle window resize
      window.addEventListener('resize', debounce(function() {
        // Close mobile menu on resize to desktop
        if (window.innerWidth > 768) {
          document.getElementById('sidebar')?.classList.remove('mobile-open');
        }
      }, 250));
    }

    async function filterHistory() {
      const searchTerm = document.getElementById('history-search')?.value.toLowerCase() || '';
      const filterValue = document.getElementById('history-filter')?.value || 'all';
      
      currentFilter = filterValue;
      currentPage = 1; // Reset to first page when filtering
      
      await loadScanHistory(currentPage, currentFilter);
    }

    // =====================================
    // UTILITY FUNCTIONS
    // =====================================

    function showNotification(message, type = 'info') {
      const container = document.getElementById('notification-container');
      const notification = document.createElement('div');
      
      notification.className = `notification notification-${type}`;
      notification.innerHTML = `
        <div class="flex items-center justify-between">
          <span>${message}</span>
          <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-xl">&times;</button>
        </div>
      `;
      
      container.appendChild(notification);
      
      // Show notification
      setTimeout(() => {
        notification.classList.add('show');
      }, 100);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          if (notification.parentElement) {
            notification.remove();
          }
        }, 300);
      }, 5000);
    }

    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    function isElementInViewport(el) {
      const rect = el.getBoundingClientRect();
      return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
      );
    }

    console.log('🔧 SENA Dashboard JavaScript loaded successfully!');
  </script>
</body>
</html>